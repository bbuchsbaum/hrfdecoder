% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/auto_rank.R
\name{estimate_rank_auto}
\alias{estimate_rank_auto}
\title{Estimate nuisance rank from whitened residuals}
\usage{
estimate_rank_auto(
  Y,
  X_list,
  X_base = NULL,
  runs = NULL,
  control = list(),
  alpha = 0.05,
  B = 50L,
  r_max = 50L,
  block_shifts = TRUE
)
}
\arguments{
\item{Y}{Numeric matrix (T x V) of voxel time series.}

\item{X_list}{List of design blocks (each T x K). If no design exists,
pass a single all-zero column to keep the code path identical to the fitter.}

\item{X_base}{Optional baseline design (T x B) subtracted after whitening.}

\item{runs}{Optional integer vector of length T with run identifiers.}

\item{control}{Optional list with entries `lambda_A_init_ridge` and
`lambda_base` for the initial ridge fits.}

\item{alpha}{Family-wise level for the parallel-analysis quantile.}

\item{B}{Number of circular-shift null draws (set to 0 to disable).}

\item{r_max}{Maximum number of singular values to probe.}

\item{block_shifts}{Logical; if TRUE, circular shifts are done voxel-wise.}
}
\value{
List with fields `r`, `r_mp`, `r_pa`, `sigma2`, `lambda_plus`, `ev`.
}
\description{
Uses a Marčenko–Pastur bulk-edge threshold together with
a parallel-analysis null (voxel-wise circular shifts) to select the
low-rank nuisance dimension after whitening and optional baseline removal.
}
