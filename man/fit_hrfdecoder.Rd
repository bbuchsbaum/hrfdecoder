% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit.R
\name{fit_hrfdecoder}
\alias{fit_hrfdecoder}
\title{Fit HRF-aware weakly supervised decoder}
\usage{
fit_hrfdecoder(
  Y,
  ev_model,
  base_model = NULL,
  hrf = NULL,
  lambda_W = 10,
  lambda_HRF = 1,
  lambda_smooth = 5,
  theta_penalty = 0.01,
  max_iter = 20,
  tol = 1e-04,
  nonneg = TRUE,
  background = TRUE,
  standardize = TRUE,
  ar_order = NULL,
  ar_method = c("ar", "arma"),
  ar_pooling = c("run", "global"),
  verbose = 1
)
}
\arguments{
\item{Y}{numeric matrix (T x V) of fMRI data (time by voxel)}

\item{ev_model}{fmridesign::event_model describing events}

\item{base_model}{optional fmridesign::baseline_model for nuisance removal}

\item{hrf}{optional fmrihrf basis object}

\item{lambda_W}{ridge penalty on decoder weights}

\item{lambda_HRF}{adherence weight to HRF prior}

\item{lambda_smooth}{temporal smoothness weight}

\item{theta_penalty}{ridge penalty on HRF basis coefficients}

\item{max_iter}{maximum ALS iterations}

\item{tol}{convergence tolerance on P updates}

\item{nonneg}{enforce non-negative soft labels}

\item{background}{include a background column in the soft labels}

\item{standardize}{z-score Y columns before fitting}

\item{ar_order}{AR order for prewhitening (default: NULL for no AR prewhitening).
Set to 1 for AR(1), 2 for AR(2), etc. Use "auto" for automatic BIC-based selection.}

\item{ar_method}{AR estimation method: "ar" (Yule-Walker) or "arma" (Hannan-Rissanen).
Default: "ar".}

\item{ar_pooling}{Spatial pooling for AR parameters: "global" (one AR model for all voxels)
or "run" (separate AR model per run). Default: "run".}

\item{verbose}{integer verbosity level}
}
\value{
object of class `hrfdecoder_fit`
}
\description{
Fit HRF-aware weakly supervised decoder
}
